{"version":3,"file":"ng-validate-equal.umd.js","sources":["../../../projects/ng-validate-equal/src/lib/ng-validate-equal.directive.ts","../../../projects/ng-validate-equal/src/lib/ng-validate-equal.module.ts","../../../projects/ng-validate-equal/src/public-api.ts","../../../projects/ng-validate-equal/src/ng-validate-equal.ts"],"sourcesContent":["import { Directive, forwardRef, Attribute, OnDestroy } from '@angular/core';\nimport { Validator, AbstractControl, NG_VALIDATORS } from '@angular/forms';\nimport { Subscription } from 'rxjs';\n\n@Directive({\n    selector: '[ngValidateEqual]',\n    providers: [\n        { provide: NG_VALIDATORS, useExisting: forwardRef(() => ValidateEqualDirective), multi: true }\n    ]\n})\nexport class ValidateEqualDirective implements Validator, OnDestroy {\n\n    private valueChangesSub: Subscription;\n\n    constructor(@Attribute('ngValidateEqual') public otherControl: string) {\n        this.valueChangesSub = new Subscription();\n    }\n\n    ngOnDestroy() {\n        if (this.valueChangesSub) {\n            this.valueChangesSub.unsubscribe();\n        }\n    }\n\n    validate(selfControl: AbstractControl): any {\n\n        const selfControlValue = selfControl.value;\n        const otherControl = selfControl.root.get(this.otherControl);\n\n        if (!otherControl) {\n            throw new Error('ng-validate-equal: \"otherControl\" is not defined, please pass the name of the main field to the directive put on the secondary field like this example: ngValidateEqual=\"passwordFieldName\"');\n        }\n\n        if (this.valueChangesSub) {\n            this.valueChangesSub.unsubscribe();\n        }\n\n        // this code works when user types in other control putting the error in self control\n        this.valueChangesSub = otherControl.valueChanges.subscribe(\n            otherControlValue => {\n                if (!this.isEqual(selfControlValue, otherControlValue) && (selfControl.touched || selfControl.dirty)) {\n                    selfControl.setErrors(\n                        {\n                            notEqual: true\n                        }\n                    );\n                } else {\n                    if (selfControl.errors && selfControl.hasError('notEqual')) {\n                        delete selfControl.errors['notEqual'];\n                        if (!Object.keys(selfControl.errors).length) { selfControl.setErrors(null); }\n                    }\n                }\n            }\n        );\n\n        // this code works when the user types in self control putting the error in self control\n        if (!this.isEqual(selfControlValue, otherControl.value) && (selfControl.touched || selfControl.dirty)) {\n            return {\n                notEqual: true\n            };\n        }\n\n        return null;\n    }\n\n    private isEqual(val1: any, val2: any) {\n        val1 = this.unifyEmptyStrings(val1);\n        val2 = this.unifyEmptyStrings(val2);\n\n        return val1 === val2;\n    }\n\n    private unifyEmptyStrings(val: any) {\n        const isDefined = this.isDefined;\n        if (val === null || !isDefined(val)) {\n            val = '';\n        }\n        return val;\n    }\n\n    private isDefined(value: any) {\n        const defaultUndefined = void (0);\n        return value !== defaultUndefined;\n    }\n\n}\n","import { NgModule } from '@angular/core';\nimport { ValidateEqualDirective } from './ng-validate-equal.directive';\n\n\n\n@NgModule({\n  declarations: [ValidateEqualDirective],\n  imports: [],\n  exports: [ValidateEqualDirective]\n})\nexport class ValidateEqualModule { }\n","/*\n * Public API Surface of ng-validate-equal\n */\n\nexport * from './lib/ng-validate-equal.directive';\nexport * from './lib/ng-validate-equal.module';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["Subscription","NG_VALIDATORS","forwardRef","Directive","Attribute","NgModule"],"mappings":"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"}